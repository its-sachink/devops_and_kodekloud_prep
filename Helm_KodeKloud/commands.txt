########### Chapter 2 : Installation and Configuration ############

- Install the helm package on the controlplane node.
    If unsure how to install the helm tool, feel free to refer to the documentation. 
    The Documentation tab is available at the top right panel.

    # curl -fsSL -o get_helm.sh https://raw.githubusercontent.com/helm/helm/main/scripts/get-helm-3
    # chmod 700 get_helm.sh
    # ./get_helm.sh

    - Documentation page location : https://helm.sh/docs/intro/install/#from-script



- Awesome ðŸ’ª!! Now that you have Helm installed âœ¨ identify the Helm version in the cluster.

    # helm version



- Which environment variable can be used to indicate whether or not Helm is running in Debug mode?
    Use the help mode of the helm command to look for this information.

    # $HELM_DEBUG                        | indicate whether or not Helm is running in Debug mode


- What is a command line flag that can be used to enable verbose output?

    # --debug                           enable verbose output

    --
  hooks       download all hooks for a named release
  manifest    download the manifest for a named release
  metadata    This command fetches metadata for a given release
  notes       download the notes for a named release
  values      download the values file for a named release





########### Lab : Using HELM to deploy the application

- Which command is used to search for a wordpress helm chart package from the Artifact Hub?

    # helm search hub wordpress


- Search for a consul helm chart package from the Artifact Hub and identify the APP VERSION for the Official HashiCorp Consul Chart.

    # helm search hub consul | grep hashicorp

        - and check the APP VERSION.


- Add bitnami helm chart repository in the controlplane node. The url for bitnami repository is https://charts.bitnami.com/bitnami

    # helm repo add bitnami https://charts.bitnami.com/bitnami



- Which command is used to search for the wordpress package from the newly added bitnami repository?

    # helm search repo wordpress


- How many helm chart repositories are there in the controlplane node now?

    # helm repo list
    NAME            URL                                                 
    bitnami         https://charts.bitnami.com/bitnami                  
    puppet          https://puppetlabs.github.io/puppetserver-helm-chart
    hashicorp       https://helm.releases.hashicorp.com



- Deploy the Apache application on the cluster using the apache from the bitnami repository.
    Set the release name to : amaze-surf

    # helm install amaze-surf bitnami/apache
    # helm install release-name repo-name/package-name


- What version of apache did we just install on the cluster using the helm chart?

    # helm list | grep -i apache
    amaze-surf      default         1               2023-12-09 03:17:05.017069989 -0500 EST deployed        apache-10.2.4   2.4.58


- How many releases of nginx charts can you see installed in the cluster now?

    # helm list | grep -i nginx
    crazy-web       default         1               2023-12-09 03:18:30.802957286 -0500 EST deployed        nginx-15.4.4    1.25.3     
    happy-browse    default         1               2023-12-09 03:18:27.578236725 -0500 EST deployed        nginx-15.4.4    1.25.3


- Uninstall the nginx chart release happy-browse from the cluster.

     # helm list | grep -i nginx
    crazy-web       default         1               2023-12-09 03:18:30.802957286 -0500 EST deployed        nginx-15.4.4    1.25.3     
    happy-browse    default         1               2023-12-09 03:18:27.578236725 -0500 EST deployed        nginx-15.4.4    1.25.3

    # helm uninstall happy-browse
    release "happy-browse" uninstalled

    # helm list | grep -i nginx
    crazy-web       default         1               2023-12-09 03:18:30.802957286 -0500 EST deployed        nginx-15.4.4    1.25.3



- Remove the Hashicorp helm repository from the cluster.

    # helm repo remove hashicorp
    "hashicorp" has been removed from your repositories




########### Lab : Upgrading a HELM chart

- Add bitnami helm chart repository to the cluster.
        Note: - Make sure to add the bitnami chart to the cluster before moving to the next questions.

    # helm repo add bitnami https://charts.bitnami.com/bitnami


- How many releases of nginx can you see in the cluster now?

    # helm list | grep -i nginx
    dazzling-web    default         3               2023-12-09 04:03:23.452329297 -0500 EST deployed        nginx-12.0.4    1.22.0


- How many revisions of nginx exists in the cluster?

    # helm history dazzling-web
    REVISION        UPDATED                         STATUS          CHART          APP VERSION      DESCRIPTION     
    1               Sat Dec  9 04:03:13 2023        superseded      nginx-12.0.4   1.22.0           Install complete
    2               Sat Dec  9 04:03:17 2023        superseded      nginx-12.0.5   1.22.0           Upgrade complete
    3               Sat Dec  9 04:03:23 2023        deployed        nginx-12.0.4   1.22.0           Upgrade complete



- Which version of nginx is currently running in the cluster?

    # Check for the "deployed" status in the HELM chart history command. It is 1.22.0



- The DevOps team has decided to upgrade the nginx to version 1.23 in the bitnami repository.
    Make sure that the nginx version running in the cluster is 1.23.x.

    - You can install any nginx helm chart version above 13 for installing 1.23.
    
    # helm upgrade dazzling-web bitnami/nginx --version 13
    helm upgrade dazzling-web bitnami/nginx --version 13
    Release "dazzling-web" has been upgraded. Happy Helming!
    NAME: dazzling-web
    LAST DEPLOYED: Sat Dec  9 04:08:13 2023
    NAMESPACE: default
    STATUS: deployed
    REVISION: 4
    TEST SUITE: None
    NOTES:
    CHART NAME: nginx
    CHART VERSION: 13.2.34
    APP VERSION: 1.23.4



- To which version is the nginx currently upgraded?

    helm list
    NAME            NAMESPACE       REVISION        UPDATED                                 STATUS          CHART           APP VERSION
    dazzling-web    default         4               2023-12-09 04:08:13.060832605 -0500 EST deployed        nginx-13.2.34   1.23.4

    - The APP VERISION is "1.23.4"


- Oops!.. There seems to be a minor issue in the website and the DevOps Team is asked to rollback the nginx to previous version!
    Please rollback the nginx to previous version.

    # helm list
    NAME            NAMESPACE       REVISION        UPDATED                                 STATUS          CHART           APP VERSION
    dazzling-web    default         4               2023-12-09 04:08:13.060832605 -0500 EST deployed        nginx-13.2.34   1.23.4

    - The current Revision is 4, lets check all the revisions.

    # helm history dazzling-web
    REVISION        UPDATED                         STATUS          CHART          APP VERSION      DESCRIPTION     
    1               Sat Dec  9 04:03:13 2023        superseded      nginx-12.0.4   1.22.0           Install complete
    2               Sat Dec  9 04:03:17 2023        superseded      nginx-12.0.5   1.22.0           Upgrade complete
    3               Sat Dec  9 04:03:23 2023        superseded      nginx-12.0.4   1.22.0           Upgrade complete
    4               Sat Dec  9 04:08:13 2023        deployed        nginx-13.2.34  1.23.4           Upgrade complete

    - Now rollback to revision 3.

    # helm rollback dazzling-web 3
    Rollback was a success! Happy Helming!